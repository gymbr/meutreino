<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Baixar Aplicativo - Meu Treino</title>
    <!-- === CHAME AQUI O MANIFEST (ajuste o caminho se necess√°rio) === -->
    <link rel="manifest" href="manifest.json">
    <!-- Opcional: meta theme color -->
    <meta name="theme-color" content="#ffc107">
    <link rel="icon" href="https://raw.githubusercontent.com/gymbr/meutreino/refs/heads/main/img/favicon.png" type="image/jpg">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <style>
        :root {
            --bg-color: #212121;
            --card-color: #2c2c2c;
            --text-color: #f0f0f0;
            --secondary-text-color: #a0a0a0;
            --primary-color: #ffc107;
            --border-radius: 12px;
            --input-bg-color: #383838;
            --menu-width: 250px;
        }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background-color: var(--bg-color); color: var(--text-color); margin: 0; padding: 0; display: flex; flex-direction: column; min-height: 100vh; overflow-x: hidden; }
        *, *::before, *::after { box-sizing: border-box; }
        .header { display: flex; justify-content: space-between; align-items: center; padding: 12px 16px; border-bottom: 1px solid var(--input-bg-color); position: sticky; top: 0; z-index: 10; background-color: var(--bg-color); }
        .header .menu-icon { font-size: 1.5rem; cursor: pointer; color: var(--primary-color); padding: 5px; }
        .header .header-link { text-decoration: none; color: inherit; position: absolute; left: 50%; transform: translateX(-50%); }
        .header .title { font-size: 1.25rem; font-weight: bold; display: flex; align-items: center; }
        .header .title img { width: 24px; height: 24px; margin-right: 8px; border-radius: 5px; }
        .header .placeholder { width: 40px; }
        .side-menu { height: 100%; width: 0; position: fixed; z-index: 1001; top: 0; left: 0; background-color: var(--card-color); overflow-x: hidden; transition: 0.3s; padding-top: 60px; box-shadow: 2px 0 5px rgba(0,0,0,0.5); display: flex; flex-direction: column; }
        .side-menu.open { width: var(--menu-width); }
        .side-menu .close-btn { position: absolute; top: 15px; right: 25px; font-size: 2rem; color: var(--primary-color); cursor: pointer; }
        .side-menu a { padding: 15px 20px; text-decoration: none; font-size: 1.1rem; color: var(--text-color); display: block; transition: 0.3s; border-bottom: 1px solid var(--input-bg-color); }
        .side-menu a:hover { background-color: #575757; color: var(--primary-color); }
        .side-menu a i { color: var(--primary-color); width: 20px; text-align: center; }
        .sponsorship-box a { border-bottom: none; }
        .side-menu .sponsorship-box { margin-top: auto; padding: 20px; text-align: center; width: 100%; }
        .side-menu .sponsorship-box img { max-width: 100%; border-radius: var(--border-radius); width: 100%; }
        #page-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.7); z-index: 1000; display: none; transition: opacity 0.3s; }
        #page-overlay.show { display: block; }

        .container { flex-grow: 1; padding: 20px; max-width: 900px; margin: 0 auto; text-align: center; }
        .page-title { color: var(--primary-color); text-align: center; font-size: 1.6rem; margin-top: 16px; margin-bottom: 24px; }
        .card p { font-size: 1rem; line-height: 1.5; color: var(--text-color); margin: 0 0 15px; }

        .btn-container { display: flex; flex-direction: column; gap: 15px; margin: 30px auto 0; width: 100%; max-width: 200px; }
        .download-link { display: block; text-decoration: none; padding: 0; border-radius: var(--border-radius); overflow: hidden; transition: transform 0.2s; line-height: 0; cursor: pointer; position: relative; }
        .download-link:hover { transform: translateY(-2px); }
        .download-link img { width: 100%; height: auto; display: block; border-radius: var(--border-radius); object-fit: cover; }

        .footer { text-align: center; padding: 8px 16px; color: var(--secondary-text-color); font-size: 0.875rem; background-color: #282828; margin-top: auto; width: 100%; }

        @media (max-width: 600px) {
            .side-menu.open { width: min(var(--menu-width), 80vw); }
        }
    </style>
</head>
<body>

    <div id="side-menu" class="side-menu">
        <a href="javascript:void(0)" class="close-btn" onclick="closeNav()">&times;</a>
        <a href="."><i class="fa-solid fa-dumbbell"></i> Meu Treino</a>
        <a href="todos-exercicios"><i class="fa-solid fa-list"></i> Todos Exerc√≠cios</a>
        <a href="biblioteca-de-treinos"><i class="fa-solid fa-book"></i> Biblioteca de Treinos</a>
        <a href="calculadora-de-saude"><i class="fa-solid fa-calculator"></i> Calculadora de Sa√∫de</a>
        <a href="personal-trainer"><i class="fa-solid fa-user"></i> Personal Trainer</a>
        <a href="baixar-aplicativo"><i class="fa-solid fa-download"></i> Baixar Aplicativo</a>
        <a href="sobre"><i class="fa-solid fa-circle-info"></i> Sobre</a>
        <div class="sponsorship-box">
            <a href="mailto:contato.meutreino@outlook.com?subject=Anunciar%20no%20App%20Meu%20Treino&body=Ol%C3%A1%2C%20gostaria%20de%20saber%20mais%20sobre%20como%20anunciar%20meu%20perfil%20no%20app%20Meu%20Treino.">
                <img src="https://raw.githubusercontent.com/gymbr/meutreino/refs/heads/main/img/anuncie_aqui.gif" alt="Anuncie Aqui">
            </a>
        </div>
    </div>
    <div id="page-overlay" onclick="closeNav()"></div>

    <div id="main-content-wrapper">
        <div class="header">
            <span class="menu-icon" onclick="openNav()">&#9776;</span>
            <a href="." class="header-link">
                <span class="title">
                    <img src="https://raw.githubusercontent.com/gymbr/meutreino/refs/heads/main/img/icone_treino.jpg" alt="√çcone de Treino">
                    Meu Treino
                </span>
            </a>
            <span class="placeholder"></span>
        </div>

        <div class="container">
            <h1 class="page-title">Baixar Aplicativo</h1>
            <p style="color: var(--secondary-text-color);">Instale o aplicativo em seu dispositivo para ter acesso r√°pido a todas as funcionalidades.</p>

            <div class="btn-container">
                <a href="https://github.com/gymbr/meutreino/releases/download/v1.0/Meu-Treino-v1.0.apk" class="download-link">
                    <img src="https://raw.githubusercontent.com/gymbr/meutreino/refs/heads/main/img/download1.png" alt="Download APK Android">
                </a>

                <a href="https://apkpure.com/meutreino/com.wMeuTreino_19109142" target="_blank" class="download-link">
                    <img src="https://raw.githubusercontent.com/gymbr/meutreino/refs/heads/main/img/download2.png" alt="Download na APKPure">
                </a>

                <!-- Bot√£o que dispara o prompt de instala√ß√£o (tem id para JS) -->
                <a id="installAppBtn" class="download-link" role="button" tabindex="0" aria-label="Adicionar √† tela inicial">
                    <img src="https://raw.githubusercontent.com/gymbr/meutreino/refs/heads/main/img/download3.png" alt="Adicionar √† tela inicial">
                </a>
            </div>
        </div>

        <footer class="footer">
            Feito por quem treina, para quem treina. üí™‚ù§Ô∏è
        </footer>
    </div>

    <script>
        function openNav() {
            document.getElementById("side-menu").classList.add('open');
            document.getElementById("page-overlay").classList.add('show');
        }
        function closeNav() {
            document.getElementById("side-menu").classList.remove('open');
            document.getElementById("page-overlay").classList.remove('show');
        }
        document.addEventListener('keydown', (event) => { if (event.key === "Escape") closeNav(); });

        // ---------- L√≥gica do Add to Home Screen ----------
        // Nota: o navegador dispara `beforeinstallprompt` quando as condi√ß√µes de PWA s√£o satisfeitas.
        // Aqui guardamos o evento e o usamos quando o usu√°rio clicar no bot√£o.
        let deferredPrompt;
        const installBtn = document.getElementById('installAppBtn');

        // Escuta o evento disparado pelo Chrome/Edge (Android)
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();              // evita o mini-infobar autom√°tico
            deferredPrompt = e;              // guarda o evento para usar depois
            // mostra um indicativo visual no bot√£o (opcional)
            installBtn.classList.add('ready');
            installBtn.classList.add('ready-to-install'); // s√≥ classe visual; CSS pode usar
        });

        // Clique no bot√£o tenta abrir o prompt nativo
        installBtn.addEventListener('click', async (ev) => {
            ev.preventDefault();
            if (deferredPrompt) {
                // abre a janela de instala√ß√£o nativa
                deferredPrompt.prompt();
                try {
                    const choice = await deferredPrompt.userChoice;
                    if (choice.outcome === 'accepted') {
                        // o usu√°rio aceitou: voc√™ pode mostrar uma mensagem, log, etc.
                        alert('‚úÖ App adicionado √† tela inicial!');
                    } else {
                        alert('‚ùå Instala√ß√£o cancelada.');
                    }
                } catch (err) {
                    console.error('Erro aguardando userChoice:', err);
                }
                deferredPrompt = null;
                installBtn.classList.remove('ready');
                installBtn.classList.remove('ready-to-install');
                return;
            }

            // Se o navegador N√ÉO disparou beforeinstallprompt (ex: iOS, ou Chrome que n√£o achou eleg√≠vel),
            // mostramos instru√ß√£o manual ‚Äî n√£o tem como for√ßar o prompt nesses casos.
            // (mantive sua instru√ß√£o original como fallback)
            const isIos = /iphone|ipad|ipod/i.test(navigator.userAgent);
            if (isIos) {
                alert('No Safari do iPhone: toque no bot√£o "Compartilhar" e escolha "Adicionar √† Tela de In√≠cio".');
            } else {
                alert('‚ÑπÔ∏èParar adicionar um atalho na sua tela inicial, toque no menu (‚ãÆ ou ‚Ä¢‚Ä¢‚Ä¢) no seu navegador e selecione a op√ß√£o "Adicionar √† tela inicial" ou "Instalar aplicativo".');
            }
        });

        // dica opcional: tentar registrar service worker caso exista (n√£o √© obrigat√≥rio para o prompt, mas recomendado)
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/meutreino/sw.js').then(() => {
                console.log('Service Worker registrado (se sw.js existir).');
            }).catch((err) => {
                // se n√£o existir, ignora ‚Äî registro n√£o √© obrigat√≥rio
                console.log('Service Worker n√£o registrado (talvez sw.js n√£o exista):', err.message);
            });
        }
    </script>
</body>
</html>
