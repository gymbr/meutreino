<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estamos de Casa Nova!</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lz-string/1.4.4/lz-string.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: #212121;
            color: #f0f0f0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            text-align: center;
            flex-direction: column;
        }
        .container {
            padding: 20px;
        }
        h1 {
            color: #ffc107;
        }
        p {
            font-size: 1.1rem;
        }
        a {
            color: #ffd54f;
            text-decoration: none;
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #ffc107;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 2s linear infinite;
            margin-top: 20px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Estamos de casa nova!</h1>
        <p>Você está sendo redirecionado para o nosso novo site.</p>
        <p>Seus treinos serão migrados automaticamente.</p>
        <a style="display:none;"><img alt="Hits" src="https://hits.sh/gymbr.github.io/meutreinoantigo.svg"/></a>
        <div class="loader"></div>
        <p style="margin-top: 20px;">
            Se o redirecionamento não funcionar, <a id="new-link" href="https://meutreinoapp.pages.dev/">clique aqui</a>.
        </p>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // 1. Defina a URL do seu novo site
            const newBaseUrl = 'https://meutreinoapp.pages.dev/';

            // Atualiza o link de fallback
            document.getElementById('new-link').href = newBaseUrl;

            try {
                // 2. Tente ler os dados de treino do localStorage do site antigo
                const workouts = localStorage.getItem('workouts');
                const tabNames = localStorage.getItem('tabNames');

                // 3. Verifique se os dados existem
                if (workouts && tabNames) {
                    // Combine os dados em um único objeto, como na sua função de compartilhamento
                    const workoutData = {
                        workouts: JSON.parse(workouts),
                        tabNames: JSON.parse(tabNames)
                    };

                    // Converta o objeto para uma string JSON
                    const jsonString = JSON.stringify(workoutData);

                    // 4. Comprima a string usando a mesma biblioteca do seu app
                    const compressedString = LZString.compressToEncodedURIComponent(jsonString);

                    // 5. Construa a URL final com o hash de importação
                    const finalUrl = `${newBaseUrl}#import-compressed=${compressedString}`;

                    // Atualiza o link de fallback com os dados
                    document.getElementById('new-link').href = finalUrl;

                    // 6. Redirecione o usuário para a nova URL
                    // Usamos window.location.replace para que o usuário não fique preso em um loop de redirecionamento se clicar em "Voltar"
                    window.location.replace(finalUrl);

                } else {
                    // Se não houver dados salvos, apenas redirecione para a página inicial do novo site
                    window.location.replace(newBaseUrl);
                }
            } catch (error) {
                console.error("Erro ao migrar os dados. Redirecionando sem dados.", error);
                // Em caso de qualquer erro, redireciona para a página principal
                window.location.replace(newBaseUrl);
            }
        });
    </script>

</body>
</html>
